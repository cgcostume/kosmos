# Katharos — cruft detection rules
#
# Each [[rules]] entry defines a pattern to match against file or folder names.
#
#   pattern                 — fnmatch pattern (e.g. "node_modules", "*.pyc")
#   category                — grouping label shown in the report
#   type                    — "folder" or "file"
#   certainty               — "high" (default) or "medium"
#   requires_project_context — if true, only match when the parent directory
#                              contains a recognised project file (default: false)
#   description             — shown in verbose mode (--verbose); explains what
#                              this cruft is and whether it is safe to remove
#
# Project context is determined by the presence of any file listed in
# [project_context].files or matching [project_context].globs.

[project_context]
files = [
    "package.json",
    "Cargo.toml",
    "pom.xml",
    "build.gradle",
    "build.gradle.kts",
    "setup.py",
    "pyproject.toml",
    "CMakeLists.txt",
    "Makefile",
    "meson.build",
    "conanfile.txt",
    "conanfile.py",
    "vcpkg.json",
    "tsconfig.json",
    "webpack.config.js",
    "vite.config.ts",
    "vite.config.js",
    "rollup.config.js",
    "angular.json",
    "nx.json",
]
globs = ["*.csproj", "*.sln", "*.vcxproj", "*.xcodeproj"]


# ═══════════════════════════════════════════════════════════════════════════
# JavaScript / TypeScript
# ═══════════════════════════════════════════════════════════════════════════

[[rules]]
pattern = "node_modules"
category = "node_modules"
type = "folder"
description = "npm/yarn/pnpm dependency tree. Definitely safe to delete — fully regenerated by 'npm install'."

[[rules]]
pattern = ".next"
category = ".next"
type = "folder"
description = "Next.js build output and cache. Definitely safe — regenerated on 'next build'."

[[rules]]
pattern = ".nuxt"
category = ".nuxt"
type = "folder"
description = "Nuxt.js build output. Definitely safe — regenerated on 'nuxt build'."

[[rules]]
pattern = ".output"
category = ".output"
type = "folder"
description = "Nuxt 3 / Nitro production output. Definitely safe — regenerated on build."

[[rules]]
pattern = ".parcel-cache"
category = ".parcel-cache"
type = "folder"
description = "Parcel bundler cache. Definitely safe — rebuilt automatically."

[[rules]]
pattern = ".turbo"
category = ".turbo"
type = "folder"
description = "Turborepo local cache. Definitely safe — rebuilt on next run."

[[rules]]
pattern = ".sass-cache"
category = ".sass-cache"
type = "folder"
description = "Ruby Sass compilation cache. Definitely safe — rebuilt on compile."

[[rules]]
pattern = ".angular"
category = ".angular"
type = "folder"
description = "Angular CLI build cache. Definitely safe — rebuilt on 'ng build'."

[[rules]]
pattern = ".nyc_output"
category = ".nyc_output"
type = "folder"
description = "Istanbul/nyc code coverage output. Definitely safe — regenerated on test run."

[[rules]]
pattern = "bower_components"
category = "bower_components"
type = "folder"
description = "Legacy Bower package manager dependencies. Definitely safe — regenerated by 'bower install'."

[[rules]]
pattern = ".eslintcache"
category = ".eslintcache"
type = "folder"
description = "ESLint lint result cache. Definitely safe — rebuilt on next lint."

[[rules]]
pattern = ".stylelintcache"
category = ".stylelintcache"
type = "folder"
description = "Stylelint CSS lint cache. Definitely safe — rebuilt on next lint."

[[rules]]
pattern = ".cache"
category = ".cache"
type = "folder"
description = "Generic tool cache (Babel, Parcel, etc.). Likely safe — rebuilt automatically by tooling."

[[rules]]
pattern = ".svelte-kit"
category = ".svelte-kit"
type = "folder"
description = "SvelteKit build output. Definitely safe — regenerated on build."

[[rules]]
pattern = ".vercel"
category = ".vercel"
type = "folder"
description = "Vercel CLI project metadata and build output. Definitely safe to delete."

[[rules]]
pattern = ".serverless"
category = ".serverless"
type = "folder"
description = "Serverless Framework build artifacts. Definitely safe — regenerated on deploy."

[[rules]]
pattern = ".webpack"
category = ".webpack"
type = "folder"
description = "Webpack cache directory. Definitely safe — rebuilt on next bundle."

[[rules]]
pattern = "storybook-static"
category = "storybook-static"
type = "folder"
description = "Storybook static site build output. Definitely safe — regenerated by 'build-storybook'."


# ═══════════════════════════════════════════════════════════════════════════
# Python
# ═══════════════════════════════════════════════════════════════════════════

[[rules]]
pattern = "__pycache__"
category = "__pycache__"
type = "folder"
description = "Python bytecode cache. Definitely safe — auto-created by the interpreter on import."

[[rules]]
pattern = ".pytest_cache"
category = ".pytest_cache"
type = "folder"
description = "Pytest result cache for re-running failures. Definitely safe to delete."

[[rules]]
pattern = ".mypy_cache"
category = ".mypy_cache"
type = "folder"
description = "Mypy type-checker incremental cache. Definitely safe — rebuilt on next check."

[[rules]]
pattern = ".ruff_cache"
category = ".ruff_cache"
type = "folder"
description = "Ruff linter cache. Definitely safe — rebuilt on next lint."

[[rules]]
pattern = ".tox"
category = ".tox"
type = "folder"
description = "Tox virtualenvs for testing across Python versions. Definitely safe — recreated by 'tox'."

[[rules]]
pattern = ".nox"
category = ".nox"
type = "folder"
description = "Nox session virtualenvs. Definitely safe — recreated by 'nox'."

[[rules]]
pattern = "*.egg-info"
category = "*.egg-info"
type = "folder"
description = "Python package metadata from setuptools. Definitely safe — regenerated on install/build."

[[rules]]
pattern = ".eggs"
category = ".eggs"
type = "folder"
description = "Setuptools downloaded build dependencies. Definitely safe to delete."

[[rules]]
pattern = ".pytype"
category = ".pytype"
type = "folder"
description = "Pytype type-checker cache. Definitely safe — rebuilt on next check."

[[rules]]
pattern = ".hypothesis"
category = ".hypothesis"
type = "folder"
description = "Hypothesis property-based testing database. Likely safe — stores shrink examples, rebuilt on test."

[[rules]]
pattern = "*.pyc"
category = "*.pyc"
type = "file"
description = "Compiled Python bytecode files. Definitely safe — auto-generated on import."

[[rules]]
pattern = "*.pyo"
category = "*.pyo"
type = "file"
description = "Optimised Python bytecode (Python 2 era). Definitely safe — auto-generated."

[[rules]]
pattern = "*.pyd"
category = "*.pyd"
type = "file"
description = "Python extension DLL (Windows). Likely safe — usually rebuilt from source."


# ═══════════════════════════════════════════════════════════════════════════
# Java / Kotlin / Gradle
# ═══════════════════════════════════════════════════════════════════════════

[[rules]]
pattern = ".gradle"
category = ".gradle"
type = "folder"
description = "Gradle build cache and wrapper files. Definitely safe — rebuilt on next build."

[[rules]]
pattern = ".m2"
category = ".m2"
type = "folder"
description = "Local Maven repository cache. Definitely safe — re-downloaded on build."


# ═══════════════════════════════════════════════════════════════════════════
# C / C++
# ═══════════════════════════════════════════════════════════════════════════

[[rules]]
pattern = "CMakeFiles"
category = "CMakeFiles"
type = "folder"
description = "CMake internal build files. Definitely safe — regenerated by 'cmake'."

[[rules]]
pattern = "CMakeCache.txt"
category = "CMakeCache.txt"
type = "file"
description = "CMake configuration cache. Definitely safe — regenerated by 'cmake'."

[[rules]]
pattern = "cmake-build-*"
category = "cmake-build-*"
type = "folder"
description = "CLion / CMake out-of-source build directories. Definitely safe — regenerated on build."

[[rules]]
pattern = "_deps"
category = "_deps"
type = "folder"
requires_project_context = true
description = "CMake FetchContent downloaded dependencies. Definitely safe — re-fetched on configure."

[[rules]]
pattern = "Debug"
category = "Debug"
type = "folder"
requires_project_context = true
description = "MSVC/CMake debug build output. Definitely safe — regenerated on build."

[[rules]]
pattern = "Release"
category = "Release"
type = "folder"
requires_project_context = true
description = "MSVC/CMake release build output. Definitely safe — regenerated on build."

# NOTE: x64/x86 folders excluded — too ambiguous, may contain meaningful data
# [[rules]]
# pattern = "x64"
# category = "x64"
# type = "folder"
# requires_project_context = true
# description = "MSVC 64-bit build output. Regenerated on build, but name is ambiguous."
#
# [[rules]]
# pattern = "x86"
# category = "x86"
# type = "folder"
# requires_project_context = true
# description = "MSVC 32-bit build output. Regenerated on build, but name is ambiguous."

[[rules]]
pattern = ".ccache"
category = ".ccache"
type = "folder"
description = "ccache compiler cache. Definitely safe — speeds up recompilation, rebuilt automatically."

[[rules]]
pattern = "ipch"
category = "ipch"
type = "folder"
description = "Visual Studio IntelliSense precompiled headers. Definitely safe — rebuilt by the IDE."

# Build artifacts (safe — always regenerable)
[[rules]]
pattern = "*.o"
category = "*.o"
type = "file"
description = "Compiled object files (GCC/Clang). Definitely safe — regenerated by the compiler."

[[rules]]
pattern = "*.obj"
category = "*.obj"
type = "file"
description = "Compiled object files (MSVC). Definitely safe — regenerated by the compiler."

[[rules]]
pattern = "*.exp"
category = "*.exp"
type = "file"
description = "MSVC export files for DLL linking. Definitely safe — regenerated by the linker."

[[rules]]
pattern = "*.ilk"
category = "*.ilk"
type = "file"
description = "MSVC incremental linker state. Definitely safe — regenerated on next link."

[[rules]]
pattern = "*.pdb"
category = "*.pdb"
type = "file"
description = "Program database (debug symbols). Definitely safe — regenerated on build."

[[rules]]
pattern = "*.idb"
category = "*.idb"
type = "file"
description = "MSVC incremental compilation database. Definitely safe — regenerated on build."

[[rules]]
pattern = "*.pch"
category = "*.pch"
type = "file"
description = "Precompiled header (MSVC). Definitely safe — regenerated by the compiler."

[[rules]]
pattern = "*.gch"
category = "*.gch"
type = "file"
description = "Precompiled header (GCC). Definitely safe — regenerated by the compiler."

[[rules]]
pattern = "*.d"
category = "*.d"
type = "file"
description = "Makefile dependency files from GCC/Clang -MD. Definitely safe — regenerated on compile."

[[rules]]
pattern = "*.su"
category = "*.su"
type = "file"
description = "GCC stack usage analysis files (-fstack-usage). Definitely safe — regenerated on compile."

# NOTE: *.dll, *.so, *.dylib, *.a, *.lib are intentionally excluded —
# they may be distributed/system binaries that are not regenerable.


# ═══════════════════════════════════════════════════════════════════════════
# .NET / C#
# ═══════════════════════════════════════════════════════════════════════════

[[rules]]
pattern = "packages"
category = "packages"
type = "folder"
requires_project_context = true
description = "NuGet package cache (older .NET). Definitely safe — restored by 'dotnet restore'."


# ═══════════════════════════════════════════════════════════════════════════
# Generic build output (requires project context)
# ═══════════════════════════════════════════════════════════════════════════

[[rules]]
pattern = "build"
category = "build"
type = "folder"
requires_project_context = true
description = "Generic build output directory. Definitely safe when inside a project — regenerated on build."

[[rules]]
pattern = "dist"
category = "dist"
type = "folder"
requires_project_context = true
description = "Distribution/bundle output (JS, Python, etc.). Definitely safe — regenerated on build."

[[rules]]
pattern = "target"
category = "target"
type = "folder"
requires_project_context = true
description = "Build output (Rust/Cargo, Maven, sbt). Definitely safe — regenerated on build."

[[rules]]
pattern = "out"
category = "out"
type = "folder"
requires_project_context = true
description = "Generic compiler/IDE output directory. Definitely safe when inside a project."


# ═══════════════════════════════════════════════════════════════════════════
# Coverage / testing
# ═══════════════════════════════════════════════════════════════════════════

[[rules]]
pattern = "coverage"
category = "coverage"
type = "folder"
description = "Code coverage reports (Istanbul, pytest-cov, etc.). Definitely safe — regenerated on test."

[[rules]]
pattern = "htmlcov"
category = "htmlcov"
type = "folder"
description = "Python coverage.py HTML reports. Definitely safe — regenerated on test."

[[rules]]
pattern = ".coverage"
category = ".coverage"
type = "folder"
description = "Python coverage.py data file/directory. Definitely safe — regenerated on test."

[[rules]]
pattern = "TestResults"
category = "TestResults"
type = "folder"
requires_project_context = true
description = ".NET test result output. Definitely safe — regenerated on test run."


# ═══════════════════════════════════════════════════════════════════════════
# Virtual environments (medium certainty)
# ═══════════════════════════════════════════════════════════════════════════

[[rules]]
pattern = ".venv"
category = ".venv"
type = "folder"
certainty = "medium"
description = "Python virtual environment. Likely safe — recreated by 'python -m venv', but may have custom packages."

[[rules]]
pattern = "venv"
category = "venv"
type = "folder"
certainty = "medium"
description = "Python virtual environment. Likely safe — recreated by 'python -m venv', but may have custom packages."

[[rules]]
pattern = "env"
category = "env"
type = "folder"
certainty = "medium"
description = "Python virtual environment (common name). Likely safe — but 'env' is an ambiguous name."


# ═══════════════════════════════════════════════════════════════════════════
# IDE / editor (medium certainty)
# ═══════════════════════════════════════════════════════════════════════════

[[rules]]
pattern = ".idea"
category = ".idea"
type = "folder"
certainty = "medium"
description = "JetBrains IDE settings (IntelliJ, PyCharm, etc.). Likely safe — but may contain custom run configs."

[[rules]]
pattern = ".vs"
category = ".vs"
type = "folder"
certainty = "medium"
description = "Visual Studio local settings and caches. Likely safe — mostly auto-generated."

# NOTE: .vscode may contain useful workspace settings (launch.json, tasks.json, etc.)
# [[rules]]
# pattern = ".vscode"
# category = ".vscode"
# type = "folder"
# certainty = "medium"
# description = "VS Code workspace settings. Often contains useful launch.json / tasks.json."

[[rules]]
pattern = "*.xcworkspace"
category = "*.xcworkspace"
type = "folder"
certainty = "medium"
description = "Xcode workspace bundle. Likely safe — regenerated, but may have custom schemes."


# ═══════════════════════════════════════════════════════════════════════════
# .NET build output (medium certainty, requires project context)
# ═══════════════════════════════════════════════════════════════════════════

[[rules]]
pattern = "bin"
category = "bin"
type = "folder"
certainty = "medium"
requires_project_context = true
description = ".NET compiled output. Definitely safe inside a .NET project — regenerated by 'dotnet build'."

[[rules]]
pattern = "obj"
category = "obj"
type = "folder"
certainty = "medium"
requires_project_context = true
description = ".NET intermediate build files. Definitely safe inside a .NET project — regenerated on build."


# ═══════════════════════════════════════════════════════════════════════════
# Windows
# ═══════════════════════════════════════════════════════════════════════════

[[rules]]
pattern = "$RECYCLE.BIN"
category = "$RECYCLE.BIN"
type = "folder"
description = "Windows Recycle Bin data (per-volume). Definitely safe — OS trash, not needed in backups."

[[rules]]
pattern = "System Volume Information"
category = "System Volume Information"
type = "folder"
description = "Windows system restore and indexing data. Definitely safe — OS-managed, not portable."

[[rules]]
pattern = "RECYCLER"
category = "RECYCLER"
type = "folder"
description = "Legacy Windows Recycle Bin (XP era). Definitely safe — OS trash."

[[rules]]
pattern = "Thumbs.db"
category = "Thumbs.db"
type = "file"
description = "Windows Explorer thumbnail cache. Definitely safe — auto-generated when viewing folders."

[[rules]]
pattern = "ehthumbs.db"
category = "ehthumbs.db"
type = "file"
description = "Windows Media Center thumbnail cache. Definitely safe — auto-generated."

[[rules]]
pattern = "ehthumbs_vista.db"
category = "ehthumbs_vista.db"
type = "file"
description = "Windows Vista Media Center thumbnail cache. Definitely safe — auto-generated."

[[rules]]
pattern = "desktop.ini"
category = "desktop.ini"
type = "file"
description = "Windows folder display settings (icon, view). Definitely safe — auto-created by Explorer."

[[rules]]
pattern = "thumbcache_*.db"
category = "thumbcache_*.db"
type = "file"
description = "Windows thumbnail cache database files. Definitely safe — rebuilt by Explorer."

[[rules]]
pattern = "IconCache.db"
category = "IconCache.db"
type = "file"
description = "Windows icon cache. Definitely safe — rebuilt automatically by the shell."

[[rules]]
pattern = "*.stackdump"
category = "*.stackdump"
type = "file"
description = "Cygwin/MSYS crash stack dumps. Definitely safe — diagnostic leftovers."


# ═══════════════════════════════════════════════════════════════════════════
# macOS
# ═══════════════════════════════════════════════════════════════════════════

[[rules]]
pattern = ".DS_Store"
category = ".DS_Store"
type = "file"
description = "macOS Finder folder metadata (icon positions, view). Definitely safe — auto-created by Finder."

[[rules]]
pattern = "._*"
category = "._*"
type = "file"
description = "macOS resource fork / extended attribute sidecar files. Definitely safe — created on non-HFS volumes."

[[rules]]
pattern = ".Spotlight-V100"
category = ".Spotlight-V100"
type = "file"
description = "macOS Spotlight search index data. Definitely safe — rebuilt automatically by the OS."

[[rules]]
pattern = ".Trashes"
category = ".Trashes"
type = "file"
description = "macOS Trash folder on external volumes. Definitely safe — OS trash, not needed in backups."

[[rules]]
pattern = ".fseventsd"
category = ".fseventsd"
type = "folder"
description = "macOS filesystem event log. Definitely safe — OS-managed, rebuilt automatically."

[[rules]]
pattern = ".TemporaryItems"
category = ".TemporaryItems"
type = "folder"
description = "macOS temporary files on external volumes. Definitely safe — transient OS data."


# ═══════════════════════════════════════════════════════════════════════════
# Linux
# ═══════════════════════════════════════════════════════════════════════════

[[rules]]
pattern = ".Trash-*"
category = ".Trash-*"
type = "folder"
description = "FreeDesktop trash directory (per-user, per-volume). Definitely safe — OS trash."

[[rules]]
pattern = "*.core"
category = "*.core"
type = "file"
description = "Process core dump files. Definitely safe — crash diagnostics, often very large."


# ═══════════════════════════════════════════════════════════════════════════
# General temp / backup files
# ═══════════════════════════════════════════════════════════════════════════

[[rules]]
pattern = "*.log"
category = "*.log"
type = "file"
description = "Log files. Likely safe — diagnostic output, usually not needed for backups."

[[rules]]
pattern = "*.tmp"
category = "*.tmp"
type = "file"
description = "Temporary files. Definitely safe — leftover transient data."

[[rules]]
pattern = "*.temp"
category = "*.temp"
type = "file"
description = "Temporary files. Definitely safe — leftover transient data."

[[rules]]
pattern = "~*"
category = "~*"
type = "file"
description = "Office/editor temporary files (Word ~$doc.docx etc.). Definitely safe — created during editing."

[[rules]]
pattern = ".~*"
category = ".~*"
type = "file"
description = "LibreOffice lock/temp files. Definitely safe — created while a document is open."

[[rules]]
pattern = "*.bak"
category = "*.bak"
type = "file"
description = "Backup files from various editors. Likely safe — old copies before an edit."

[[rules]]
pattern = "*.swp"
category = "*.swp"
type = "file"
description = "Vim swap files (crash recovery). Definitely safe — created during editing sessions."

[[rules]]
pattern = "*.swo"
category = "*.swo"
type = "file"
description = "Vim swap file overflow. Definitely safe — created alongside .swp files."

[[rules]]
pattern = "*.orig"
category = "*.orig"
type = "file"
description = "Merge conflict originals (git, patch). Likely safe — pre-merge backup copies."

[[rules]]
pattern = "*.rej"
category = "*.rej"
type = "file"
description = "Rejected patch hunks. Definitely safe — leftover from failed patch application."

[[rules]]
pattern = "*~"
category = "*~"
type = "file"
description = "Editor backup files (Emacs, nano, etc.). Definitely safe — auto-created before saves."
